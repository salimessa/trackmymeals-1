<%- include('../partials/header') %>

    <div class="text-center">
        <div class="row">
            <div class="col-9">
                <h2>Daily Meal Tracker</h2>
                <% if (meals.length) { %>
                    <table class="table table-striped table-bordered table-hover text-center">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Breakfast</th>
                                <th>Lunch</th>
                                <th>Dinner</th>
                                <th>Snack(s)</th>
                                <th>Details</th>
                            </tr>
                        </thead>
                        <tbody>
                            <% meals.forEach(function(m) { %>
                                <tr>
                                    <td>
                                        <%= (m.date.getMonth() + 1) + '/' + (m.date.getDate() + 1) + '/' +
                                            m.date.getFullYear() %>
                                    </td>
                                    <td>
                                        <%= m.breakfast %>
                                    </td>
                                    <td>
                                        <%= m.lunch %>
                                    </td>
                                    <td>
                                        <%= m.dinner %>
                                    </td>
                                    <td>
                                        <%= m.snacks %>
                                    </td>
                                    <td><a href="/meals/<%=m._id%>/edit">Edit</a>
                                    </td>
                                </tr>
                                <% }); %>
                        </tbody>
                    </table>
            </div>
            <div class="col">
                <h2>Daily Calorie Intake</h2>
                <% meals.forEach(function(d) { %>
                    <button class="accordion">
                        <%= (d.date.getMonth() + 1) + '/' + (d.date.getDate() + 1) + '/' + d.date.getFullYear() %>
                    </button>
                    <div class="panel">
                        <table>
                            <tr>
                                <th>Daily Calories</th>
                                <th>Calorie Breakdown</th>
                            </tr>
                            <tr>
                                <td>
                                    <%= d.breakfastCals + d.lunchCals + d.dinnerCals + d.snackCals %>
                                <td><a href="/meals/<%= d._id%>">Details</a></td>
                            </tr>
                        </table>
                    </div>
                    <% }); %>
            </div>
        </div>
        <% } else {%>
            <h2 class="blink">No data to present</h2>
            <% } %>
    </div>

    <script>
        var acc = document.getElementsByClassName("accordion");
        var i;

        for (i = 0; i < acc.length; i++) {
            acc[i].addEventListener("click", function () {
                this.classList.toggle("active");
                var panel = this.nextElementSibling;
                if (panel.style.display === "block") {
                    panel.style.display = "none";
                } else {
                    panel.style.display = "block";
                }
            });
        }
    </script>

<%- include('../partials/footer') %>